

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>xAH FAQ &mdash; xAODAnaHelpers 9618850 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
        <script src="_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/collapsible-lists/css/tree_view.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="API.html" />
    <link rel="prev" title="Brian Tuan’s Tutorial" href="Tutorial_BrianTuan.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> xAODAnaHelpers
          

          
          </a>

          
            
            
              <div class="version">
                9618850
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installing.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="UsingUs.html">xAH_run.py</a></li>
<li class="toctree-l1"><a class="reference internal" href="Algorithms.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="Development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="Community.html">Community</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">xAH FAQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i">How do I…</a></li>
<li class="toctree-l2"><a class="reference internal" href="#slc6-vs-slc7">SLC6 vs SLC7</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="API.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/library_root.html">Doxygen API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">xAODAnaHelpers</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>xAH FAQ</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/FAQs.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="xah-faq">
<span id="faq"></span><h1>xAH FAQ<a class="headerlink" href="#xah-faq" title="Permalink to this headline">¶</a></h1>
<p>This is a list of Frequently Asked Questions about xAODAnaHelpers and analysis software. Feel free to suggest new entries!</p>
<div class="section" id="how-do-i">
<h2>How do I…<a class="headerlink" href="#how-do-i" title="Permalink to this headline">¶</a></h2>
<dl>
<dt>… submit a grid (prun) job?</dt><dd><p>Start with a minimal environment:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">lsetup</span><span class="w"> </span><span class="n">panda</span>
</pre></div>
</div>
<p>and a minimal configuration script:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">from</span><span class="w"> </span><span class="n">xAH_config</span><span class="w"> </span><span class="k">import</span><span class="w"> </span><span class="n">xAH_config</span>
<span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xAH_config</span><span class="p">()</span>
<span class="n">c</span><span class="p">.</span><span class="n">algorithm</span><span class="p">(</span><span class="s">&quot;BasicEventSelection&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;m_name&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;test&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;m_useMetaData&quot;</span><span class="o">:</span><span class="w"> </span><span class="n">False</span><span class="p">})</span>
</pre></div>
</div>
<p>Then we can submit a job:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">xAH_run</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="o">--</span><span class="n">inputRucio</span><span class="w"> </span><span class="o">--</span><span class="n">files</span><span class="w"> </span><span class="s">&quot;user.lgagnon.370150.Gtt.DAOD_SUSY10.e4049_s2608_r6765_r6282_p2411_tag_10_v1_output_xAOD.root&quot;</span><span class="w"> </span>\
<span class="o">--</span><span class="n">config</span><span class="o">=</span><span class="n">test</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="n">prun</span><span class="w"> </span><span class="o">--</span><span class="n">optGridMergeOutput</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span>\
<span class="o">--</span><span class="n">optGridNFilesPerJob</span><span class="o">=</span><span class="mf">1.0</span><span class="w"> </span><span class="o">--</span><span class="n">optGridOutputSampleName</span><span class="o">=</span><span class="n">user</span><span class="p">.</span><span class="n">gstark</span><span class="p">.</span><span class="n">test</span>
</pre></div>
</div>
</dd>
<dt>… submit <code class="docutils literal notranslate"><span class="pre">xAH_run</span></code> jobs with production privileges?</dt><dd><p>You can use <code class="docutils literal notranslate"><span class="pre">--optSubmitFlags=&quot;--official&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">--optOfficial=1</span></code> (?):</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="w">   </span><span class="n">xAH_run</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="o">--</span><span class="n">files</span><span class="w"> </span><span class="n">MultijetAlgo</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">grid_samples_EXOT1_data</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="o">--</span><span class="n">inputList</span><span class="w"> </span>\
<span class="w">   </span><span class="o">--</span><span class="n">config</span><span class="w"> </span><span class="n">MultijetAlgo</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">config_MultijetAlgo</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="o">--</span><span class="n">inputDQ2</span><span class="w"> </span><span class="n">prun</span><span class="w"> </span>\
<span class="o">--</span><span class="n">optGridOutputSampleName</span><span class="o">=</span><span class="s">&quot;group.phys-exotics.%in:name[1]%.%in:name[2]%.%in:name[3]%.v0.1_20150921/&quot;</span><span class="w"> </span>\
<span class="o">--</span><span class="n">optSubmitFlags</span><span class="o">=</span><span class="s">&quot;--official&quot;</span>
</pre></div>
</div>
</dd>
<dt>… use <code class="docutils literal notranslate"><span class="pre">AnaToolHandle</span></code> for ASG CP tools?</dt><dd><p>Unfortunately there’s no much documentation out there, so everything written here comes from direct email question to ASG fellows, or looking at the <a class="reference external" href="https://svnweb.cern.ch/trac/atlasoff/browser/Control/AthToolSupport/AsgTools/trunk/AsgTools/AnaToolHandle.h">source code</a></p>
<ol class="arabic">
<li><p>Make the tool handle as a member of a xAH algorithm (NB: remember to set the <strong>interface</strong> class of the CP tool. Just prepend an `I` to the tool type):</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MyAlgo</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">xAH</span><span class="o">::</span><span class="n">Algorithm</span>
<span class="p">{</span>
<span class="w">  </span><span class="p">...</span>
<span class="w">  </span><span class="k">private</span><span class="o">:</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">    </span><span class="n">asg</span><span class="o">::</span><span class="n">AnaToolHandle</span><span class="o">&lt;</span><span class="n">IMyToolType</span><span class="o">&gt;</span><span class="w">   </span><span class="n">m_mytool_handle</span><span class="p">;</span><span class="w"> </span><span class="c1">//!</span>

<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>In the xAH algorithm initialisation list, call the tool handle constructor. The argument of the constructor must be a string with the tool type and tool name separated by a slash `/` . In general, the tool name in the constructor can be just a dummy string, as it can be changed afterwards:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">MyAlgo</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">MyAlgo</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">className</span><span class="p">)</span><span class="w"> </span><span class="o">:</span>
<span class="w">  </span><span class="p">...</span>
<span class="w">  </span><span class="n">m_mytool_handle</span><span class="p">(</span><span class="s">&quot;MyToolType/MyToolName&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="p">...</span>
<span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="p">...</span>
<span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>In some cases the name of the tool has to be different than the one set in the constructor. E.g., for the efficiency correctors, the tool names must depend on the configuration of the algorithm, which is set only <strong>after</strong> the initialisation list is executed. In such situations, the name of the tool can be modified (typically this would happen in <code class="docutils literal notranslate"><span class="pre">EL::initialize()</span></code>) with:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">EL</span><span class="o">::</span><span class="n">StatusCode</span><span class="w"> </span><span class="n">BasicEventSelection</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">initialize</span><span class="w"> </span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="p">...</span>
<span class="w">  </span><span class="n">m_mytool_handle</span><span class="p">.</span><span class="n">make</span><span class="p">(</span><span class="s">&quot;MyToolType/MyToolNewName&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">EL::initialize()</span></code>, set the properties and initialise the tool handle. After <code class="docutils literal notranslate"><span class="pre">m_mytool_handle.initialize()</span></code> has been called, it will effectively behave like a pointer to the tool itself:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">EL</span><span class="o">::</span><span class="n">StatusCode</span><span class="w"> </span><span class="n">BasicEventSelection</span><span class="w"> </span><span class="o">::</span><span class="w"> </span><span class="n">initialize</span><span class="w"> </span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="p">...</span>
<span class="w">  </span><span class="n">m_mytool_handle</span><span class="p">.</span><span class="n">make</span><span class="p">(</span><span class="s">&quot;MyToolType/MyToolNewName&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">m_mytool_handle</span><span class="p">.</span><span class="n">SetProperty</span><span class="p">(...);</span>
<span class="w">  </span><span class="n">m_mytool_handle</span><span class="p">.</span><span class="n">initialize</span><span class="p">();</span>
<span class="w">  </span><span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>In the algorithm, use the tool associated to the handle via calls like <code class="docutils literal notranslate"><span class="pre">m_mytool_handle-&gt;doStuff()</span></code>.</p></li>
<li><p>The tool associated to the handle will be automatically destroyed when appropriate. Hence, no need to call <code class="docutils literal notranslate"><span class="pre">delete</span></code> anywhere.</p></li>
</ol>
<p>If the same tool (identified by its name) needs to be used in another xAH algorithm downstream, just declare a tool handle member with the same <code class="docutils literal notranslate"><span class="pre">IMyToolType</span></code>, call its constructor in the initialisation list and (if needed) change its tool name with <code class="docutils literal notranslate"><span class="pre">make()</span></code>. Then in <code class="docutils literal notranslate"><span class="pre">EL::initialize()</span></code> simply call <code class="docutils literal notranslate"><span class="pre">m_mytool_handle.initialize()</span></code>, without setting any property. It will automagically get the pointer to the correct tool from a registry, and all the tool properties will be preserved from the previous initialisation.</p>
</dd>
</dl>
</div>
<div class="section" id="slc6-vs-slc7">
<h2>SLC6 vs SLC7<a class="headerlink" href="#slc6-vs-slc7" title="Permalink to this headline">¶</a></h2>
<p>If you’re running into issues with grid submission because of checks for SLC7-compatible machines in <cite>xAH_run.py</cite> preventing you from doing so, then you can either:</p>
<ul class="simple">
<li><p>ssh into lxplus SLC7 (<code class="docutils literal notranslate"><span class="pre">lxplus.cern.ch</span></code>)</p></li>
<li><p>run in a containerized SLC7 environment (<code class="docutils literal notranslate"><span class="pre">setupATLAS</span> <span class="pre">-c</span> <span class="pre">slc6</span></code>)</p></li>
</ul>
<p>If you think this message is happening in error, <a class="reference external" href="https://github.com/UCATLAS/xAODAnaHelpers/issues/new">file an issue</a> giving us the output from the following commands:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lsb_release</span> <span class="pre">-d</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">printenv</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">_PLATFORM</span></code></p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="API.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Tutorial_BrianTuan.html" class="btn btn-neutral float-left" title="Brian Tuan’s Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2017, ATLAS Collaboration

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>